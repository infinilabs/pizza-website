<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.79.1"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Date histogram aggregation #  This multi-bucket aggregation is similar to the normal histogram, but it can only be used with date or date range values. Because dates are represented internally in Elasticsearch as long values, it is possible, but not as accurate, to use the normal histogram on dates as well. The main difference in the two APIs is that here the interval can be specified using date/time expressions. Time-based data requires special support because time-based intervals are not always a fixed length."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Date histogram aggregation"><meta property="og:description" content="Date histogram aggregation #  This multi-bucket aggregation is similar to the normal histogram, but it can only be used with date or date range values. Because dates are represented internally in Elasticsearch as long values, it is possible, but not as accurate, to use the normal histogram on dates as well. The main difference in the two APIs is that here the interval can be specified using date/time expressions. Time-based data requires special support because time-based intervals are not always a fixed length."><meta property="og:type" content="article"><meta property="og:url" content="/docs/references/aggregation/date-histogram/"><meta property="article:modified_time" content="2024-08-28T14:58:55+08:00"><title>Date histogram aggregation | INFINI Pizza</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.aeb4e729664d188f8782b134d28cd51900d8d45b0ffff2d5b2ac899394f551af.css integrity="sha256-rrTnKWZNGI+HgrE00ozVGQDY1FsP//LVsqyJk5T1Ua8="><script defer src=/js/jquery-2.x.min.js></script><script defer src=/js/doc.js></script><link rel=stylesheet crossorigin href=/assets/index-C1z1vz3D.css></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><img src=/img/logo-en.svg alt=Logo></a></h2><div style=margin-bottom:20px id=docsearch></div><div class=heading><select class=version-selector>
<option value>main (latest)</option>
<option value=v0.1.0>v0.1.x</option></select></div><ul><li><input type=checkbox id=section-f3f48e330869cc09ea97a30269be4c02 class=toggle>
<label for=section-f3f48e330869cc09ea97a30269be4c02 class="flex justify-between"><a href=/docs/overview/>Overview</a>
<span>▾</span></label><ul><li><a href=/docs/overview/concept/>Concepts</a></li><li><a href=/docs/overview/architecture/>Architecture</a></li><li><a href=/docs/overview/sharding/>Why named Pizza</a></li><li><a href=/docs/overview/realtime/>How realtime works</a></li></ul></li><li><input type=checkbox id=section-f1b7c1b2e5dd43526e77637c475d35b8 class=toggle>
<label for=section-f1b7c1b2e5dd43526e77637c475d35b8 class="flex justify-between"><a>Getting started</a>
<span>▾</span></label><ul><li><a href=/docs/getting-started/installation/>Installation</a></li><li><a href=/docs/getting-started/configuration/>Configuration</a></li><li><a href=/docs/getting-started/cli/>Pizza CLI</a></li></ul></li><li><input type=checkbox id=section-fb088f8a9be33f7f260ad2b140bb7bdc class=toggle checked>
<label for=section-fb088f8a9be33f7f260ad2b140bb7bdc class="flex justify-between"><a href=/docs/references/>References</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-02e44f0bf96750fc4746f16db998ed66 class=toggle>
<label for=section-02e44f0bf96750fc4746f16db998ed66 class="flex justify-between"><a href=/docs/references/namespace/>Namespace</a>
<span>▾</span></label><ul><li><a href=/docs/references/namespace/create/>Create a namespace</a></li><li><a href=/docs/references/namespace/delete/>Delete a namespace</a></li></ul></li><li><input type=checkbox id=section-f15027c2778b7b081844da5b47c26928 class=toggle>
<label for=section-f15027c2778b7b081844da5b47c26928 class="flex justify-between"><a href=/docs/references/collection/>Collection</a>
<span>▾</span></label><ul><li><a href=/docs/references/collection/create/>Create a collection</a></li><li><a href=/docs/references/collection/delete/>Delete a collection</a></li><li><a href=/docs/references/collection/get/>Get collection</a></li><li><a href=/docs/references/collection/get_index/>Get collection index</a></li><li><a href=/docs/references/collection/get_rollings/>Get collection rollings</a></li><li><a href=/docs/references/collection/get_schema/>Get collection schema</a></li><li><a href=/docs/references/collection/get_settings/>Get collection settings</a></li></ul></li><li><input type=checkbox id=section-fdb9f1bc0d458c0de14afb266e4e1e5b class=toggle>
<label for=section-fdb9f1bc0d458c0de14afb266e4e1e5b class="flex justify-between"><a href=/docs/references/index/>Index</a>
<span>▾</span></label><ul><li><a href=/docs/references/index/create/>Create an index</a></li><li><a href=/docs/references/index/delete/>Delete an index</a></li><li><a href=/docs/references/index/get/>Get index</a></li><li><a href=/docs/references/index/get_alias/>Get index alias</a></li><li><a href=/docs/references/index/get_mapping/>Get index mapping</a></li><li><a href=/docs/references/index/get_settings/>Get index setting</a></li></ul></li><li><input type=checkbox id=section-eebb290e3504e78bfaf0e003938d0d72 class=toggle>
<label for=section-eebb290e3504e78bfaf0e003938d0d72 class="flex justify-between"><a href=/docs/references/types/>Types</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-6604cf186da4b984c93b54305f8d7768 class=toggle>
<label for=section-6604cf186da4b984c93b54305f8d7768 class="flex justify-between"><a href=/docs/references/types/type_parameter/>Type Parameter</a>
<span>▾</span></label></li></ul></li><li><input type=checkbox id=section-232f0668f3be6ea64e1c220baec34dfc class=toggle>
<label for=section-232f0668f3be6ea64e1c220baec34dfc class="flex justify-between"><a href=/docs/references/document/>Document</a>
<span>▾</span></label><ul><li><a href=/docs/references/document/create/>Create a document</a></li><li><a href=/docs/references/document/fetch/>Fetch a document</a></li><li><a href=/docs/references/document/replace/>Replace a document</a></li><li><a href=/docs/references/document/partial_update/>Partial update a document</a></li><li><a href=/docs/references/document/delete/>Delete a document</a></li><li><a href=/docs/references/document/bulk/>Batch document operation</a></li></ul></li><li><input type=checkbox id=section-271895e92dddd3f684dfff70bbed20a6 class=toggle>
<label for=section-271895e92dddd3f684dfff70bbed20a6 class="flex justify-between"><a href=/docs/references/api_convention/>API conventions</a>
<span>▾</span></label><ul></ul></li><li><input type=checkbox id=section-6b02990358c7382bac3f39043e5fd437 class=toggle>
<label for=section-6b02990358c7382bac3f39043e5fd437 class="flex justify-between"><a href=/docs/references/search/>Search</a>
<span>▾</span></label><ul><li><a href=/docs/references/search/prefix/>Prefix query</a></li><li><a href=/docs/references/search/range/>Range query</a></li><li><a href=/docs/references/search/regexp/>Regexp query</a></li><li><a href=/docs/references/search/term/>Term query</a></li></ul></li><li><input type=checkbox id=section-69a0462c4990a8b0bf6189289fb56e8a class=toggle checked>
<label for=section-69a0462c4990a8b0bf6189289fb56e8a class="flex justify-between"><a href=/docs/references/aggregation/>Aggregation</a>
<span>▾</span></label><ul><li><a href=/docs/references/aggregation/avg/>Avg aggregation</a></li><li><a href=/docs/references/aggregation/date-histogram/ class=active>Date histogram aggregation</a></li><li><a href=/docs/references/aggregation/max/>Max aggregation</a></li><li><a href=/docs/references/aggregation/min/>Min aggregation</a></li><li><a href=/docs/references/aggregation/percentiles/>Percentiles aggregation</a></li><li><a href=/docs/references/aggregation/sum/>Sum aggregation</a></li><li><a href=/docs/references/aggregation/terms/>Terms aggregation</a></li><li><a href=/docs/references/aggregation/value-count/>Value count aggregation</a></li></ul></li><li><a href=/docs/references/configuration/>Configuration</a><ul><li><a href=/docs/references/configuration/region_settings/>Region Settings</a></li></ul></li></ul></li><li><input type=checkbox id=section-4815ea2eab133dd85c2b2a9323d3691d class=toggle>
<label for=section-4815ea2eab133dd85c2b2a9323d3691d class="flex justify-between"><a href=/docs/administration/>Administration</a>
<span>▾</span></label><ul><li><input type=checkbox id=section-abab1b050dc3433070befb160d0b2fa6 class=toggle>
<label for=section-abab1b050dc3433070befb160d0b2fa6 class="flex justify-between"><a>Observability</a>
<span>▾</span></label><ul><li><a href=/docs/administration/observability/health/>Cluster health</a></li><li><a href=/docs/administration/observability/state/>Cluster state</a></li></ul></li></ul></li><li><a href=/docs/release-notes/>Release notes</a><ul></ul></li><li><a href=/docs/community/>Community</a><ul></ul></li></ul><ul><li><a href=/posts/>Blogs
<img height=10px style=vertical-align:middle src=/svg/external-link.svg class=book-icon alt="Open in new window"></a></li><li><a href=https://engine-benchmarks.pizza.rs/ target=_blank rel=noopener>Benchmarks
<img height=10px style=vertical-align:middle src=/svg/external-link.svg class=book-icon alt="Open in new window"></a></li><li><a href=https://github.com/infinilabs/pizza target=_blank rel=noopener>Github
<img height=10px style=vertical-align:middle src=/svg/external-link.svg class=book-icon alt="Open in new window"></a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Date histogram aggregation</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#date-histogram-aggregation>Date histogram aggregation</a><ul><li><a href=#examples>Examples</a></li><li><a href=#parameters-for-date_histogram>Parameters for <code>date_histogram</code></a><ul><li><a href=#calendar_interval><code>calendar_interval</code></a></li><li><a href=#fixed_interval><code>fixed_interval</code></a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=date-histogram-aggregation>Date histogram aggregation
<a class=anchor href=#date-histogram-aggregation>#</a></h1><p>This multi-bucket aggregation is similar to the normal histogram, but it can
only be used with date or date range values. Because dates are represented
internally in Elasticsearch as long values, it is possible, but not as accurate,
to use the normal histogram on dates as well. The main difference in the two
APIs is that here the interval can be specified using date/time expressions.
Time-based data requires special support because time-based intervals are not
always a fixed length.</p><h2 id=examples>Examples
<a class=anchor href=#examples>#</a></h2><p>As an example, here is an aggregation requesting bucket intervals of a month in
calendar time:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>POST /sales/_search
<span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;aggs&#34;</span>: <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;sales_over_time&#34;</span>: <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;date_histogram&#34;</span>: <span style=color:#f92672>{</span>
        <span style=color:#e6db74>&#34;field&#34;</span>: <span style=color:#e6db74>&#34;date&#34;</span>,
        <span style=color:#e6db74>&#34;calendar_interval&#34;</span>: <span style=color:#e6db74>&#34;1M&#34;</span>
      <span style=color:#f92672>}</span>
    <span style=color:#f92672>}</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Response:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#f92672>{</span>
  ...
  <span style=color:#e6db74>&#34;aggregations&#34;</span>: <span style=color:#f92672>{</span>
    <span style=color:#e6db74>&#34;sales_over_time&#34;</span>: <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;buckets&#34;</span>: <span style=color:#f92672>[</span>
        <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;key&#34;</span>: 1420070400000,
          <span style=color:#e6db74>&#34;doc_count&#34;</span>: <span style=color:#ae81ff>3</span>
        <span style=color:#f92672>}</span>,
        <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;key&#34;</span>: 1422748800000,
          <span style=color:#e6db74>&#34;doc_count&#34;</span>: <span style=color:#ae81ff>2</span>
        <span style=color:#f92672>}</span>,
        <span style=color:#f92672>{</span>
          <span style=color:#e6db74>&#34;key&#34;</span>: 1425168000000,
          <span style=color:#e6db74>&#34;doc_count&#34;</span>: <span style=color:#ae81ff>2</span>
        <span style=color:#f92672>}</span>
      <span style=color:#f92672>]</span>
    <span style=color:#f92672>}</span>
  <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span>
</code></pre></div><h2 id=parameters-for-date_histogram>Parameters for <code>date_histogram</code>
<a class=anchor href=#parameters-for-date_histogram>#</a></h2><ul><li><code>field</code><br>(Required, string) Field you wish to aggregate.</li></ul><h3 id=calendar_interval><code>calendar_interval</code>
<a class=anchor href=#calendar_interval>#</a></h3><p>(Optional, string) Calendar-aware intervals are configured with the
<code>calendar_interval</code> parameter. You can specify calendar intervals using the unit
name, such as <code>month</code>, or as a single unit quantity, such as <code>1M</code>. For example,
<code>day</code> and <code>1d</code> are equivalent. Multiple quantities, such as <code>2d</code>, are not
supported.</p><p>The accepted calendar intervals are:</p><ul><li><code>minute</code>, <code>1m</code><br>All minutes begin at 00 seconds. One minute is the interval between 00 seconds
of the first minute and 00 seconds of the following minute in the specified time
zone, compensating for any intervening leap seconds, so that the number of minutes
and seconds past the hour is the same at the start and end.</li><li><code>hour</code>, <code>1h</code><br>All hours begin at 00 minutes and 00 seconds. One hour (1h) is the interval between
00:00 minutes of the first hour and 00:00 minutes of the following hour in the
specified time zone, compensating for any intervening leap seconds, so that the
number of minutes and seconds past the hour is the same at the start and end.</li><li><code>day</code>, <code>1d</code><br>All days begin at the earliest possible time, which is usually 00:00:00 (midnight).
One day (1d) is the interval between the start of the day and the start of the
following day in the specified time zone, compensating for any intervening time
changes.</li><li><code>week</code>, <code>1w</code><br>One week is the interval between the start day_of_week:hour:minute:second and the
same day of the week and time of the following week in the specified time zone.</li><li><code>month</code>, <code>1M</code><br>One month is the interval between the start day of the month and time of day and
the same day of the month and time of the following month in the specified time
zone, so that the day of the month and time of day are the same at the start and
end.</li><li><code>quarter</code>, <code>1q</code><br>One quarter is the interval between the start day of the month and time of day
and the same day of the month and time of day three months later, so that the day
of the month and time of day are the same at the start and end.</li><li><code>year</code>, <code>1y</code><br>One year is the interval between the start day of the month and time of day and
the same day of the month and time of day the following year in the specified time
zone, so that the date and time are the same at the start and end.</li></ul><h3 id=fixed_interval><code>fixed_interval</code>
<a class=anchor href=#fixed_interval>#</a></h3><p>Fixed intervals are configured with the <code>fixed_interval</code> parameter.</p><p>In contrast to calendar-aware intervals, fixed intervals are a fixed number of
SI units and never deviate, regardless of where they fall on the calendar. One
second is always composed of <code>1000ms</code>. This allows fixed intervals to be
specified in any multiple of the supported units.</p><p>However, it means fixed intervals cannot express other units such as months,
since the duration of a month is not a fixed quantity. Attempting to specify a
calendar interval like month or quarter will throw an exception.</p><p>The accepted units for fixed intervals are:</p><ul><li><strong>milliseconds</strong> (<code>ms</code>)<br>A single millisecond. This is a very, very small interval.</li><li><strong>seconds</strong> (<code>s</code>)<br>Defined as 1000 milliseconds each.</li><li><strong>minutes</strong> (<code>m</code>)<br>Defined as 60 seconds each (60,000 milliseconds). All minutes begin at 00 seconds.</li><li><strong>hours</strong> (<code>h</code>)<br>Defined as 60 minutes each (3,600,000 milliseconds). All hours begin at 00 minutes
and 00 seconds.</li><li><strong>days</strong> (<code>d</code>)<br>Defined as 24 hours (86,400,000 milliseconds). All days begin at the earliest possible
time, which is usually 00:00:00 (midnight).</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/infinilabs/pizza/commit/830e9c08a79e7d49ddad2d5fda7742078898fb34 title="Last modified by Medcl | August 28, 2024" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 28, 2024</span></a></div><div><a class="flex align-center" href=https://github.com/infinilabs/pizza/edit/main/website/content.en/docs/references/aggregation/date-histogram.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div><div class="flex align-center footer">©INFINI.LTD, All Rights Reserved.</div><script async src="https://www.googletagmanager.com/gtag/js?id=G-VV6PGDHH84"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-VV6PGDHH84');</script><script type=text/javascript>var _smartsupp=_smartsupp||{};_smartsupp.key='691ff544d18a237005a011a7290b839d8fe811a4';window.smartsupp||(function(d){var s,c,o=smartsupp=function(){o._.push(arguments)};o._=[];s=d.getElementsByTagName('script')[0];c=d.createElement('script');c.type='text/javascript';c.charset='utf-8';c.async=true;c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);})(document);</script><script type=module crossorigin src=/assets/index-D_gOo737.js></script></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#date-histogram-aggregation>Date histogram aggregation</a><ul><li><a href=#examples>Examples</a></li><li><a href=#parameters-for-date_histogram>Parameters for <code>date_histogram</code></a><ul><li><a href=#calendar_interval><code>calendar_interval</code></a></li><li><a href=#fixed_interval><code>fixed_interval</code></a></li></ul></li></ul></li></ul></nav></aside></main></body></html>